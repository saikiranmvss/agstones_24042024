<html>
    
    <head>
        <title>Product Collection | Agastya Stones</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
        <link rel="shortcut icon" href="../images/favicon.png" type="image/x-icon">
        <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
        <link href="../assets/libs/sweetalert2/sweetalert2.min.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.css" integrity="sha512-UTNP5BXLIptsaj5WdKFrkFov94lDx+eBvbKyoe1YAfjeRPC+gT5kyZ10kOHCfNZqEui1sxmqvodNUx3KbuYI/A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
        <style>
        
        .delete-prod {
                top: 25% !important;
                color: red !important;
                font-size: 25px !important;
            }
        
            .prod-gallery .wrap img{
                width: 100%;
                /* cursor: pointer; */
                height: 250px;
                object-fit: cover;
            }
            .product-edit-pen{
                width: 460px;
                height: 250px;
                position: relative;
                background-image: linear-gradient(280deg, black, transparent);
            }
            .product-edit-pen i {
                color: #000;
                font-size: 20px;
                position: absolute;
                right: 5%;
                top: 10%;
            }
        </style>
        <meta name="google-site-verification" content="bfCBd4mgQPj-PuPRehsfzP8JSiX_fp2R9JnEftNgayA" />
   <%- include('../head') %>
<meta name="robots" content="noindex,nofollow">
    </head>
    
    <body>
        
        <button onclick="topFunction()" id="topscroll" title="Go to top"><i class="fas fa-chevron-up"></i></button>
        <%- include('../header') %>
        
        
        <div class="innerbanner prodpage">
            <div class="main"><div class="content">
               <h1 class="title">Product Collection</h1>
                <div class="desline"></div>
            </div>
            </div>
        </div>
        
        <form class="filterbar" id="filterbar">
           
                    </form>
        <div id="main-div">
        <div class="prod-gallery" id="prod-gallery">
           <div class="col-12 p-0 filter-div">
            <div class="btn-group pe-2 d-flex align-items-center"> 

            </div>
            <div>
                
            </div>        
        </div>
            <% if(loadProds!=''){ 
            for(j=0;j< loadProds.length; j++){        

            %>

                <a href="javascript:void(0)" class="wrap" data-color="<%=loadProds[j].prod_primary_color%>" data-finish="<%=JSON.parse(loadProds[j].prod_finishes).join(',')%>" data-cat="<%=loadProds[j].prod_stone_cat%>" data-size1="<%=loadProds[j].prod_slab_size1%>" data-size2="<%=loadProds[j].prod_slab_size2%>">
                <div class="product-edit-pen"><img src="images/resized/<%=JSON.parse(loadProds[j].prod_images)[0]%>"><i class="bi bi-pen" onclick="window.location.href='products_edit/<%=loadProds[j].prod_id%>'"></i><i class="bi bi-trash delete-prod" onclick="delete_prod('<%=loadProds[j].prod_id%>')"></i></div>
                    
                    <h5><%=loadProds[j].prod_name%></h5>
                </a>
            

           <%} } %>

            
        </div>
           </div>
        <div class="text-center mb-4" onclick="loadMore()"><button type="button" class="btn btn-dark">Load more</button><input type="hidden" value="18" id="load-more-add"></div>
        
        
<%- include('../footer') %>
        
        
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        
        <script>
            AOS.init();
        </script>
        
       <script>
        $(document).ready(function() {
              var owl = $('.productgalcarousel');
              owl.owlCarousel({
                loop: true,
                margin: 0,
                responsiveClass:true,
				autoplay:true,
				autoplayTimeout:4000,
				autoplayHoverPause:true,
                responsive:{
                    0:{
                        items:1,
                        nav:true
                    },
                    600:{
                        items:1,
                        nav:true
                    },
                    1000:{
                        items:1,
                        nav:true,
                        loop:true
                    }
                }
                });
              
            })
        
        </script>
        
       <script>
        $(document).ready(function() {
              var owl = $('.homeprodcarousel');
              owl.owlCarousel({
                loop: true,
                margin: 30,
                responsiveClass:true,
				autoplay:true,
				autoplayTimeout:4000,
				autoplayHoverPause:true,
                responsive:{
                    0:{
                        items:1,
                        nav:true
                    },
                    600:{
                        items:2,
                        nav:true
                    },
                    1000:{
                        items:3,
                        nav:true,
                        loop:true
                    }
                }
                });
              
            })
        
        </script>
        
        <script>
            let mybutton = document.getElementById("topscroll");

            window.onscroll = function() {scrollFunction()};

            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    mybutton.style.display = "block";
                } 
                else {
                    mybutton.style.display = "none";
                }
            }
            
            function topFunction() {
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
            }
        </script>
        
        <script>
$(window).scroll(function() {
  var scroll = $(window).scrollTop();
	$(".innerbanner").css({
		backgroundSize: (100 + scroll/15)  + "%",
		top: -(scroll/10)  + "%",

	});
  
});

$(document).on('click', '.options input' ,function(){

    filterCall();

})

function filterCall(){


   // $('.prod-gallery a').hide();

    var finishes = $('.option_finish input:checked').map(function() {
        $('.prod-gallery a[data-finish*="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();
    var stoneCats = $('.option_cat input:checked').map(function() {
        $('.prod-gallery a[data-cat="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();
    var colors = $('.option_color input:checked').map(function() {
        $('.prod-gallery a[data-color="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();
    var sizes = $('.option_size input:checked').map(function() {
        $('.prod-gallery a[data-size1="'+$(this).val()+'"]').show();
        $('.prod-gallery a[data-size2="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();

    let sortVal=$('#sort-value').val();
    let loadMore=$('#load-more-add').val();

    let details={formName:'filter-sort',sortVal:sortVal,finishes:finishes.join(','),stoneCats:stoneCats.join(','),colors:colors.join(','),sizes:sizes.join(','),loadMore:loadMore};

    $.ajax({
        type:'post',
        data:details,
        url:'/filter-products',
        // url:'admin/products-ajax.php',
        success:function(data){
            $('.prod-gallery .wrap').remove();
            $('.filter-div').after(data);
        }        
    })


}

function resetCall(){

document.getElementById('filterbar').reset();
filterCall();
}

function loadMore(){

    let loadVal=parseInt($('#load-more-add').val());
    $('#load-more-add').val(loadVal+18);
    filterCall();

}

const searchProd = (value)=>{
let string=  value.toLowerCase();

$('.prod-gallery a').hide();
if(string==''){

    $("#main-div").load(location.href + " #prod-gallery");

}else{
    
    $.ajax({
        type:'post',
        // url:'admin/products-ajax.php',
        url:'/search-products',
        data:{string:string,formName:'search'},
        success:function(data){
            $('.prod-gallery .wrap').remove();
            $('.filter-div').after(data);
        }
    })
}

}

     
async function delete_prod(prod_id){

Swal.fire({
    icon: 'warning',
    title: 'Are you Sure ?',
    // input: 'text',
    showCancelButton:!0,
    inputPlaceholder: 'Reason to Delete',
    confirmButtonText:"Delete!",
    confirmButtonColor:"#1cbb8c",
    cancelButtonColor:"#ff3d60",
    inputValidator: (value) => {
        if (!value) {
        return 'You need to write something!'
        }
    }
    }).then(function(t){
        if(t.isConfirmed){
            deleteFun(prod_id);
        }
    })
}

function deleteFun(prod_id){

$.ajax({
    type:'post',
    data:{prod_id:prod_id,formName:'delete_prod'},
    url:'/delete_prod',
    success:function(data){
        if(data==1){
            location.reload();
        }else{
            alert('Something went wrong. Please try again');
        }
    }
})
}

</script>
        
        

<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="../assets/libs/sweetalert2/sweetalert2.min.js"></script>
    </body>
    
</html>