<html>
    
    <head>
       <title>Product Collection | Agastya Stones</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
        <%- include('head'); %>
        <style>
            .prod-gallery .wrap img{
                width: 100%;
                /* cursor: pointer; */
                height: 250px;
                object-fit: cover;
            }
            .option_color{
                    height: 50vh;
                    overflow-y: scroll;
            }
                    .filter-div{
                display: flex;
                justify-content: flex-end;
                align-items: center;
            }
        </style>
        <meta name="google-site-verification" content="bfCBd4mgQPj-PuPRehsfzP8JSiX_fp2R9JnEftNgayA" />
<!-- Google tag (gtag.js) -->   
<meta name="robots" content="noindex,nofollow">
    </head>
    
    <body>
        <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WTVQJ7SR"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

        
        <button onclick="topFunction()" id="topscroll" title="Go to top"><i class="fas fa-chevron-up"></i></button>
        
        <%- include('header'); %>
        
        <div class="innerbanner prodpage">
            <div class="main"><div class="content">
               <h1 class="title">Product Collection</h1>
                <div class="desline"></div>
            </div>
            </div>
        </div>
        
        <form class="filterbar" id="filterbar">
            <div class="buttn">
                Colour <i class="fas fa-chevron-down"></i>
                <div class="options option_color">
                    <% if(filter.prod_primary_color!=''){ 
                        let colors = filter.prod_primary_color.split(',');
var color = [...new Set(colors)];

                        for(i=0;i< color.length; i++){
        
                        %>
                    <label>
                        <input type="checkbox" class="filter-option" value="<%=color[i]%>" id="<%=color[i]%>"> <%=color[i]%>
                    </label>
                        <%  } }else{ %>
                      <label for="">No Colors</label>      
                    <% } %>
                </div>
            </div>
            <div class="buttn">
                Material <i class="fas fa-chevron-down"></i>
                <div class="options option_cat">
                    <% if(filter.prod_stone_cat!=''){  %>
                        <label>
                        <input type="checkbox" value="0"> Granite
                    </label>
                    <label>
                        <input type="checkbox" value="1"> Quartz
                    </label>
                    <label>
                        <input type="checkbox" value="2"> Quartzite
                    </label>
                    <label>
                        <input type="checkbox" value="3"> Marble
                    </label>
                    <label>
                        <input type="checkbox" value="4"> Onyx
                    </label>
                    <label>
                        <input type="checkbox" value="5"> Semi Precious
                    </label>
                    <label>
                        <input type="checkbox" value="6"> Porcelain
                    </label>
                        <% }else{ %>
                        <label for="">No Material</label>
                       <% } %>
                </div>
            </div>
            <div class="buttn">
                Thickness <i class="fas fa-chevron-down"></i>
                <div class="options option_size">
                <% if(filter.sizes!=''){ 
                let sizes = filter.sizes.split(',');
                for(k=0;k< sizes.length; k++){

                %>

                <label>
                    <input type="checkbox" value="<%= sizes[k] %>"> <%= sizes[k] %>
                </label>

                <%
                    
                } }else{ %>                    
                    <label for="">No Sizes</label>
                <% } %>
                </div>
            </div>
            <div class="buttn">
                Finish <i class="fas fa-chevron-down"></i>
                <div class="options option_finish">
                    <% if(filter.prod_finishes){ %>
                    <label>
                        <input type="checkbox" value="0"> Polished
                    </label>
                    <label>
                        <input type="checkbox" value="1"> Honed
                    </label>
                    <label>
                        <input type="checkbox" value="2"> Matte
                    </label>
                    <label>
                        <input type="checkbox" value="3"> Leather
                    </label>
                    <% }else { %>
                        <label for="">No Finishes</label>
                    <% } %>
                </div>            
            </div>
                    </form>
        <div id="main-div">
        <div class="prod-gallery" id="prod-gallery">
           <div class="col-12 p-0 filter-div">
            <div class="btn-group pe-2 d-flex align-items-center"> 
                <input type="hidden" value="0" id="sort-value">
                <input class="form-control" style="width:220px;margin-right:1rem" type="search" oninput="searchProd(this.value)" placeholder="Search" aria-label="Search">
                <i class="fa fa-filter" aria-hidden="true" type="button" id="defaultDropdown" data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false" ></i>
                <ul class="dropdown-menu" aria-labelledby="defaultDropdown">
                    <li><a class="dropdown-item" href="javascript:void(0)" onclick="$('#sort-value').val(1);filterCall();">A - Z</a></li>
                    <li><a class="dropdown-item" href="javascript:void(0)" onclick="$('#sort-value').val(2);filterCall();">Category</a></li>
                </ul>
            </div>
            <div>
                <button class="productreset" onclick="resetCall()">Reset <i class="far fa-arrow-alt-circle-right"></i></button>
            </div>        
        </div>
        <%
                
        function createSlug(text) {
            let slug = text.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
            return slug;
        }
        
        if(loadProds!=''){ 

            for(j=0;j< loadProds.length; j++){        

            %>

            <a href="product/<%=createSlug(loadProds[j].prod_name)%>" prod-name="<%=loadProds[j].prod_name.toLowerCase()%>" class="wrap" data-color="<%=loadProds[j].prod_primary_color%>" data-finish="<%=JSON.parse(loadProds[j].prod_finishes).join(',')%>" data-cat="<%=loadProds[j].prod_stone_cat%>" data-size1="<%=loadProds[j].prod_slab_size1%>" data-size2="<%=loadProds[j].prod_slab_size2%>" >
                <img src="images/resized/<%=JSON.parse(loadProds[j].prod_images)[0]%>">
                <h5><%=loadProds[j].prod_name%></h5>
            </a>

           <%} } %>

            
        </div>
           </div>
        <div class="text-center mb-4" onclick="loadMore()"><button type="button" class="btn btn-dark">Load more</button><input type="hidden" value="18" id="load-more-add"></div>
        
        
<%- include('footer') %>
        
        
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        
        <script>
            AOS.init();
        </script>
        
       <script>
        $(document).ready(function() {
              var owl = $('.productgalcarousel');
              owl.owlCarousel({
                loop: true,
                margin: 0,
                responsiveClass:true,
				autoplay:true,
				autoplayTimeout:4000,
				autoplayHoverPause:true,
                responsive:{
                    0:{
                        items:1,
                        nav:true
                    },
                    600:{
                        items:1,
                        nav:true
                    },
                    1000:{
                        items:1,
                        nav:true,
                        loop:true
                    }
                }
                });
              
            })
        
        </script>
        
       <script>
        $(document).ready(function() {
              var owl = $('.homeprodcarousel');
              owl.owlCarousel({
                loop: true,
                margin: 30,
                responsiveClass:true,
				autoplay:true,
				autoplayTimeout:4000,
				autoplayHoverPause:true,
                responsive:{
                    0:{
                        items:1,
                        nav:true
                    },
                    600:{
                        items:2,
                        nav:true
                    },
                    1000:{
                        items:3,
                        nav:true,
                        loop:true
                    }
                }
                });
              
            })
        
        </script>
        
        <script>
            let mybutton = document.getElementById("topscroll");

            window.onscroll = function() {scrollFunction()};

            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    mybutton.style.display = "block";
                } 
                else {
                    mybutton.style.display = "none";
                }
            }
            
            function topFunction() {
                document.body.scrollTop = 0;
                document.documentElement.scrollTop = 0;
            }
        </script>
        
        <script>
$(window).scroll(function() {
  var scroll = $(window).scrollTop();
	$(".innerbanner").css({
		backgroundSize: (100 + scroll/15)  + "%",
		top: -(scroll/10)  + "%",

	});
  
});

$(document).on('click', '.options input' ,function(){

    filterCall();

})

function filterCall(){


   // $('.prod-gallery a').hide();

    var finishes = $('.option_finish input:checked').map(function() {
        $('.prod-gallery a[data-finish*="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();
    var stoneCats = $('.option_cat input:checked').map(function() {
        $('.prod-gallery a[data-cat="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();
    var colors = $('.option_color input:checked').map(function() {
        $('.prod-gallery a[data-color="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();
    var sizes = $('.option_size input:checked').map(function() {
        $('.prod-gallery a[data-size1="'+$(this).val()+'"]').show();
        $('.prod-gallery a[data-size2="'+$(this).val()+'"]').show();
        return $(this).val();
    }).get();

    let sortVal=$('#sort-value').val();
    let loadMore=$('#load-more-add').val();

    let details={formName:'filter-sort',sortVal:sortVal,finishes:finishes.join(','),stoneCats:stoneCats.join(','),colors:colors.join(','),sizes:sizes.join(','),loadMore:loadMore};

    $.ajax({
        type:'post',
        data:details,
        url:'/filter-products',
        // url:'admin/products-ajax.php',
        success:function(data){
            $('.prod-gallery .wrap').remove();
            $('.filter-div').after(data);
        }        
    })


}

function resetCall(){

document.getElementById('filterbar').reset();
filterCall();
}

function loadMore(){

    let loadVal=parseInt($('#load-more-add').val());
    $('#load-more-add').val(loadVal+18);
    filterCall();

}

const searchProd = (value)=>{
let string=  value.toLowerCase();

$('.prod-gallery a').hide();
if(string==''){

    $("#main-div").load(location.href + " #prod-gallery");

}else{
    
    $.ajax({
        type:'post',
        // url:'admin/products-ajax.php',
        url:'/search-products',
        data:{string:string,formName:'search'},
        success:function(data){
            $('.prod-gallery .wrap').remove();
            $('.filter-div').after(data);
        }
    })
}

}

</script>
        
        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    </body>
    
</html>
